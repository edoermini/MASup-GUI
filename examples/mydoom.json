{"malware_sample": "C:\\Users\\user\\Desktop\\unpacked_fff0ccf5feaf5d46b295f770ad398b6d572909b00e2b8bcd1b1c286c70cd9151.exe", "workflow": {"workflow": {"nodes": {"start": {"type": "activity", "name": "Start", "description": "", "phase": "", "color": "", "results": [], "tools": []}, "extr_0": {"type": "decision", "name": "Malware Specimen Hidden?", "description": "", "phase": "extraction", "color": "#4051B5", "results": [], "tools": []}, "extr_1": {"type": "activity", "name": "Automatic Extraction", "description": "", "phase": "extraction", "color": "#4051B5", "results": [], "tools": []}, "extr_2": {"type": "decision", "name": "Has it Been Extracted?", "description": "", "phase": "extraction", "color": "#4051B5", "results": [], "tools": []}, "extr_3": {"type": "activity", "name": "Manual Extraction", "description": "", "phase": "extraction", "color": "#4051B5", "results": [], "tools": []}, "extr_4": {"type": "activity", "name": "Extract from archive", "description": "", "phase": "extraction", "color": "#4051B5", "results": [], "tools": []}, "exan_0": {"type": "activity", "name": "Identify the hash", "description": "", "phase": "Preliminary analysis", "color": "#EA8ABA", "results": [], "tools": ["pestudio"]}, "exan_1": {"type": "activity", "name": "Check for malware", "description": "", "phase": "Preliminary analysis", "color": "#EA8ABA", "results": [], "tools": ["ssdeep", "pestudio"]}, "exan_2": {"type": "activity", "name": "Data in open sources", "description": "", "phase": "Preliminary analysis", "color": "#EA8ABA", "results": [], "tools": []}, "exan_3": {"type": "activity", "name": "Text strings", "description": "", "phase": "Preliminary analysis", "color": "#EA8ABA", "results": [], "tools": ["pestudio", "idapro", "bintext", "winhex", "peview"]}, "exan_4": {"type": "activity", "name": "File Format", "description": "", "phase": "Preliminary analysis", "color": "#EA8ABA", "results": [], "tools": ["pestudio", "idapro", "binwalk", "pebrowse", "dependencywalker", "lordpe", "peview"]}, "unpk_0": {"type": "activity", "name": "Detection of packers or chiphers", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": ["peview", "pestudio", "bintext", "pebrowse", "fileinsight", "peid", "die", "binwalk", "yara"]}, "unpk_1": {"type": "decision", "name": "Obfuscated/Compressed or encrypted?", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": []}, "unpk_2": {"type": "decision", "name": "Packer identified?", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": []}, "unpk_3": {"type": "activity", "name": "Automatic decryption or unpacking", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": ["pebrowse", "winhex", "peexplorer", "procdump32", "upx"]}, "unpk_4": {"type": "decision", "name": "Has it been automatically decrypted or unpacked?", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": []}, "unpk_5": {"type": "activity", "name": "Manual decryption or unpacking", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": ["idapro", "ollydbg"]}, "unpk_6": {"type": "decision", "name": "Has it been manually decrypted or unpacked?", "description": "", "phase": "Unpacking", "color": "#2CD551", "results": [], "tools": []}, "stic_0": {"type": "activity", "name": "Static code analysis", "description": "", "phase": "Static analysis", "color": "#FFC009", "results": [], "tools": ["pebrowse", "idapro", "ghidra", "loadlib"]}, "dnmc_0": {"type": "activity", "name": "Dynamic code analysis", "description": "", "phase": "Dynamic analysis", "color": "#FF5252", "results": [], "tools": ["idapro", "ollydbg", "loadlib"]}, "dnmc_3": {"type": "decision", "name": "Need Static Analysis?", "description": "", "phase": "Dynamic analysis", "color": "#FF5252", "results": [], "tools": []}, "dnmc_4": {"type": "decision", "name": "Need More Dynamic Analysis?", "description": "", "phase": "Dynamic analysis", "color": "#FF5252", "results": [], "tools": []}, "impt_0": {"type": "activity", "name": "Check Import Table", "description": "", "phase": "Import table reconstruction", "color": "#9C27B0", "results": [], "tools": ["pestudio", "pebrowse", "idapro", "scylla", "lordpe"]}, "impt_1": {"type": "decision", "name": "Import table corrupted", "description": "", "phase": "Import table reconstruction", "color": "#9C27B0", "results": [], "tools": []}, "impt_2": {"type": "activity", "name": "Reconstruct import table", "description": "", "phase": "Import table reconstruction", "color": "#9C27B0", "results": [], "tools": ["importreconstructor", "icddumpfix", "scylla"]}, "bhvr_0": {"type": "activity", "name": "Pre execution tasks", "description": "", "phase": "Behavioral analysis", "color": "#00A99D", "results": [], "tools": ["gdiproc", "systracer", "autoruns", "regshot", "dirwatch", "processhacker", "apatedns", "spymetool", "malcodeanalystpack", "netcat", "psfile", "processexplorer", "wireshark", "mailpot", "sniffhit", "processmonitor"]}, "bhvr_1": {"type": "activity", "name": "Run malware", "description": "", "phase": "Behavioral analysis", "color": "#00A99D", "results": [], "tools": ["unpacked_fff0ccf5feaf5d46b295f770ad398b6d572909b00e2b8bcd1b1c286c70cd9151.exe"]}, "bhvr_2": {"type": "activity", "name": "Post execution tasks", "description": "", "phase": "Behavioral analysis", "color": "#00A99D", "results": [], "tools": ["gdiproc", "systracer", "autoruns", "regshot", "dirwatch", "processhacker", "apatedns", "spymetool", "malcodeanalystpack", "netcat", "psfile", "processexplorer", "wireshark", "mailpot", "sniffhit", "processmonitor"]}, "bhvr_3": {"type": "activity", "name": "Dump and RAM analysis", "description": "", "phase": "Behavioral analysis", "color": "#00A99D", "phase_id": 6, "activity_id": 3, "results": [], "tools": ["processmonitor", "processexplorer", "systracer", "processhacker", "autoruns", "gdiproc"]}, "bhvr_4": {"type": "activity", "name": "HD analysis", "description": "", "phase": "Behavioral analysis", "color": "#00A99D", "results": [], "tools": ["spymetool", "regshot", "systracer", "process_monitor", "psfile", "dirwatch"]}, "bhvr_5": {"type": "activity", "name": "Network analysis", "description": "", "phase": "Behavioral analysis", "color": "#00A99D", "results": [], "tools": ["wireshark", "malcodeanalystpack", "netcat", "processexplorer", "systracer", "processmonitor", "apatedns", "sniffhit", "mailpot"]}, "stop": {"type": "activity", "name": "End", "description": "", "phase": "", "color": "", "results": [], "tools": []}}, "edges": [{"source": "start", "destination": "extr_0", "value": ""}, {"source": "extr_0", "destination": "extr_1", "value": "Yes"}, {"source": "extr_0", "destination": "bhvr_0", "value": "No"}, {"source": "extr_1", "destination": "extr_2", "value": ""}, {"source": "extr_2", "destination": "extr_3", "value": "No"}, {"source": "extr_2", "destination": "extr_4", "value": "Yes"}, {"source": "extr_3", "destination": "extr_4", "value": ""}, {"source": "extr_4", "destination": "bhvr_0", "value": ""}, {"source": "bhvr_0", "destination": "bhvr_1", "value": ""}, {"source": "bhvr_1", "destination": "bhvr_2", "value": ""}, {"source": "bhvr_2", "destination": "bhvr_3", "value": ""}, {"source": "bhvr_3", "destination": "bhvr_4", "value": ""}, {"source": "bhvr_4", "destination": "bhvr_5", "value": ""}, {"source": "bhvr_5", "destination": "exan_0", "value": ""}, {"source": "exan_0", "destination": "exan_1", "value": ""}, {"source": "exan_1", "destination": "exan_2", "value": ""}, {"source": "exan_2", "destination": "exan_3", "value": ""}, {"source": "exan_3", "destination": "exan_4", "value": ""}, {"source": "exan_4", "destination": "unpk_0", "value": ""}, {"source": "unpk_0", "destination": "unpk_1", "value": ""}, {"source": "unpk_1", "destination": "unpk_2", "value": "Yes"}, {"source": "unpk_1", "destination": "stic_0", "value": "No"}, {"source": "unpk_2", "destination": "unpk_3", "value": "Yes"}, {"source": "unpk_2", "destination": "unpk_5", "value": "No"}, {"source": "unpk_3", "destination": "unpk_4", "value": ""}, {"source": "unpk_4", "destination": "exan_3", "value": "Yes"}, {"source": "unpk_4", "destination": "unpk_5", "value": "No"}, {"source": "unpk_5", "destination": "unpk_6", "value": ""}, {"source": "unpk_6", "destination": "impt_0", "value": "Yes"}, {"source": "unpk_6", "destination": "dnmc_0", "value": "No"}, {"source": "impt_0", "destination": "impt_1", "value": ""}, {"source": "impt_1", "destination": "impt_2", "value": "Yes"}, {"source": "impt_1", "destination": "stic_0", "value": "No"}, {"source": "impt_2", "destination": "exan_3", "value": ""}, {"source": "stic_0", "destination": "dnmc_0", "value": ""}, {"source": "dnmc_0", "destination": "dnmc_3", "value": ""}, {"source": "dnmc_3", "destination": "stic_0", "value": "Yes"}, {"source": "dnmc_3", "destination": "dnmc_4", "value": "No"}, {"source": "dnmc_4", "destination": "dnmc_0", "value": "Yes"}, {"source": "dnmc_4", "destination": "stop", "value": "No"}]}, "tools": {"pestudio": {"regex": "(?i)^pestudio(?:\\.exe)?", "nature": "GUI"}, "ssdeep": {"regex": "(?i)^ssdeep(?:\\.exe)?", "nature": "CLI"}, "idapro": {"regex": "(?i)^ida(?:pro)?(?:64)?(?:\\.exe)?", "nature": "GUI"}, "bintext": {"regex": "(?i)^bintext(?:\\.exe)?", "nature": "GUI"}, "pebrowse": {"regex": "(?i)^pebrowse(?:.*)(?:\\.exe)?", "nature": "GUI"}, "fileinsight": {"regex": "(?i)^fileinsight(?:\\.exe)?", "nature": "GUI"}, "peid": {"regex": "(?i)^peid(?:\\.exe)?", "nature": "GUI"}, "die": {"regex": "(?i)^die(?:\\.exe)?", "nature": "GUI"}, "binwalk": {"regex": "(?i)^binwalk(?:\\.exe)?", "nature": "CLI"}, "yara": {"regex": "(?i)^yara(?:\\.exe)?", "nature": "CLI"}, "winhex": {"regex": "(?i)^winhex(?:\\.exe)?", "nature": "GUI"}, "peexplorer": {"regex": "(?i)^pe(?:\\\\s)?explorer(?:\\.exe)?", "nature": "GUI"}, "procdump32": {"regex": "(?i)^procdump32(?:\\.exe)?", "nature": "CLI"}, "scylla": {"regex": "(?i)^scylla(?:\\.exe)?", "nature": "GUI"}, "upx": {"regex": "(?i)^upx(?:\\.exe)?", "nature": "CLI"}, "ghidra": {"regex": "(?i)^ghidra(?:\\.exe)?", "nature": "GUI"}, "ollydbg": {"regex": "(?i)^ollydbg(?:\\.exe)?", "nature": "GUI"}, "importreconstructor": {"regex": "(?i)^imp(?:ort)?rec(?:onstructor)?(?:\\.exe)?", "nature": "GUI"}, "processmonitor": {"regex": "(?i)^proc(?:ess)?mon(?:itor)?(?:32|64)?(?:\\.exe)?", "nature": "GUI"}, "processexplorer": {"regex": "(?i)^process(?:\\s)?explorer(?:\\.exe)?", "nature": "GUI"}, "systracer": {"regex": "(?i)^systracer(?:\\.exe)?", "nature": "GUI"}, "processhacker": {"regex": "(?i)^processhacker(?:\\.exe)?", "nature": "GUI"}, "autoruns": {"regex": "(?i)^autoruns(?:\\.exe)?", "nature": "GUI"}, "spymetool": {"regex": "(?i)^spymetool(?:\\.exe)?", "nature": "GUI"}, "regshot": {"regex": "(?i)^regshot(?:\\.exe)?", "nature": "GUI"}, "psfile": {"regex": "(?i)^psfile(?:\\.exe)?", "nature": "CLI"}, "wireshark": {"regex": "(?i)^wireshark(?:\\.exe)?", "nature": "GUI"}, "dirwatch": {"regex": "(?i)^dirwatch(?:\\.exe)?", "nature": "GUI"}, "fakedns": {"regex": "(?i)^fakedns(?:\\.exe)?", "nature": "CLI-GUI"}, "finddll": {"regex": "(?i)^finddll(?:\\.exe)?", "nature": "CLI"}, "mailpot": {"regex": "(?i)^mailpot(?:\\.exe)?", "nature": "GUI"}, "sniffhit": {"regex": "(?i)^sniffhit(?:\\.exe)?", "nature": "GUI"}, "icddumpfix": {"regex": "(?i)^icddumpfix(?:\\.exe)?", "nature": "GUI"}, "gdiproc": {"regex": "(?i)^gdiproc(?:\\.exe)?", "nature": "CLI"}, "loadlib": {"regex": "(?i)^loadlib(?:\\.exe)?", "nature": "CLI"}, "netcat": {"regex": "(?i)^netcat(?:\\.exe)?", "nature": "CLI"}, "apatedns": {"regex": "(?i)^apatedns(?:\\.exe)?", "nature": "GUI"}, "dependencywalker": {"regex": "(?i)^dependency(?:\\s*)walker(?:\\.exe)?", "nature": "GUI"}, "lordpe": {"regex": "(?i)^lordpe(?:\\.exe)?", "nature": "GUI"}, "peview": {"regex": "(?i)^peview(?:\\.exe)?", "nature": "GUI"}, "unpacked_fff0ccf5feaf5d46b295f770ad398b6d572909b00e2b8bcd1b1c286c70cd9151.exe": {"regex": "unpacked_fff0ccf5feaf5d46b295f770ad398b6d572909b00e2b8bcd1b1c286c70cd9151.exe"}}}, "activities": {"exan_0": {"start_time": 1703355034.674434, "active": false, "stop_time": 488.2799837589264}, "exan_1": {"start_time": 1703355034.674434, "active": false, "stop_time": 488.2799837589264}, "exan_3": {"start_time": 1703355034.674434, "active": false, "stop_time": 488.2799837589264}, "exan_4": {"start_time": 1703355034.674434, "active": false, "stop_time": 488.2799837589264}, "unpk_0": {"start_time": 1703355034.674434, "active": false, "stop_time": 488.2799837589264}, "impt_0": {"start_time": 1703355034.674434, "active": false, "stop_time": 488.2799837589264}, "unpk_5": {"start_time": 1703355528.969771, "active": false, "stop_time": 55540.1738319397}, "stic_0": {"start_time": 1703355528.969771, "active": false, "stop_time": 55540.1738319397}, "dnmc_0": {"start_time": 1703355528.969771, "active": false, "stop_time": 55540.1738319397}, "bhvr_0": {"start_time": 1703356034.0308826, "active": false, "stop_time": 55035.11272025108}, "bhvr_2": {"start_time": 1703356034.0308826, "active": false, "stop_time": 55035.11272025108}, "bhvr_3": {"start_time": 1703356034.0308826, "active": false, "stop_time": 55035.11272025108}, "bhvr_5": {"start_time": 1703356034.0308826, "active": false, "stop_time": 55035.11272025108}}, "activity_log": [{"tool": "", "activity": "Set malware sample", "executable": "", "arguments": ["C:\\Users\\user\\Desktop\\fff0ccf5feaf5d46b295f770ad398b6d572909b00e2b8bcd1b1c286c70cd9151.exe"], "log_time": 1703354209.912401, "notes": ""}, {"tool": "upx", "activity": "Unpack", "executable": "", "arguments": [], "log_time": 1703354940.2998214, "notes": ""}, {"tool": "", "activity": "Set malware sample", "executable": "", "arguments": ["C:\\Users\\user\\Desktop\\unpacked_fff0ccf5feaf5d46b295f770ad398b6d572909b00e2b8bcd1b1c286c70cd9151.exe"], "log_time": 1703354953.488775, "notes": ""}, {"tool": "pestudio", "activity": "Open tool", "executable": "pestudio.exe", "arguments": [], "log_time": 1703355034.674434, "notes": "# Imports\nSeeing the list of imports the malware probably edits and creates a registry keys using `RegSetValueA` and `RegCreateValueA`.\n\nThere are also network connections indicators: `gethostbyvalue`, `connect`, `send`, `recv`.\n\nIt also create mutexes using `CreateMutexA`, spawns another process using `CreateProcessA`, it searches through the filesystem using `FindNextFileA` and `FindFirstFileA`."}, {"tool": "pestudio", "activity": "Close tool", "executable": "pestudio.exe", "arguments": [], "log_time": 1703355522.9544177, "notes": ""}, {"tool": "idapro", "activity": "Open tool", "executable": "ida64.exe", "arguments": [], "log_time": 1703411484.7353065, "notes": "# String Encryption\nThe sample uses the function at `0x4A465E`, it takes an address and an encrypted string. looking at the cross references to this function implies that it\u2019s definitely a string decryptor as it gets called from too many placess across the binary. The decryption algorithm is pretty simple it\u2019s actually rot13.\n\nI decrypted the strings and added them as comments using IDAPython to speed up the reversing process.\n\n\n\tfrom idc import *\n\tfrom idautils import * \n\timport codecs\n\n\tdef get_function_arg(addr):\n    \t\twhile True:\n        \t\t\taddr = PrevHead(addr) #addr of the first push\n        \t\t\taddr= prev_head(addr) #addr of the second push\n        \t\t\tif GetMnem(addr) == \"push\":\n            \t\t\t\tbreak\n    \t\toffset = GetOperandValue(addr, 0) \n    \n    \t\tif offset=='esi' :\n        \t\t\taddr = prev_head(addr) #get the push right before strlen function call\n        \t\t\toffset = GetOperandValue(addr, 0)\n    \n    \t\tif is_loaded(offset): # offset is a valid offset\n        \t\t\tsize = get_item_size(offset)\n        \t\t\tencrypted_str = get_bytes(offset, size)\n    \t\telse: encrypted_str = offset\n         \n    \t\treturn encrypted_str # string @ offset\n\n\tdecryption_function= 0x4A465E\n\txrefs = CodeRefsTo(decryption_function, 0)\n\n\tfor fun_call in xrefs:\n    \t\tenc_str = get_function_arg(fun_call)\n    \t\tdec_str =  codecs.decode(enc_str,'rot13') if type(enc_str)==str else enc_str\n    \t\tset_cmt(fun_call , str(dec_str), 0)  \n\n# Spreading (Kazaa Spread)\n\n> Kazaa is a peer-to-peer file sharing application program for the Microsoft Windows platform\n\nThe worm copies itself under one of the following names along with a random extension in the user shared folder on the kazaa network.\n\n\n## Names\n* winamp5\n* icq2004-final\n* activation_crack\n* strip-girl-2.0bdcom_patches\n* rootkitXP\n* office_crack\n\n## Extensions\n\n* .exe\n* .src\n* .pif\n* .bat\n\n## Mass Mailing\n### Generating Sender Email\nIt adds one of the following names: `\"john\" ,\"john\" ,\"alex\" ,\"michael\" ,\"james\" ,\"mike\" ,\"kevin\" ,\"david\" ,\"george\" ,\"sam\" ,\"andrew\" ,\"jose\" ,\"leo\" ,\"maria\" ,\"jim\" ,\"brian\" ,\"serg\" ,\"mary\" ,\"ray\" ,\"tom\" ,\"peter\" ,\"robert\" ,\"bob\" ,\"jane\" ,\"joe\" ,\"dan\" ,\"dave\" ,\"matt\" ,\"steve\" ,\"smith\" ,\"stan\" ,\"bill\" ,\"bob\" ,\"jack\" ,\"fred\" ,\"ted\" ,\"adam\" ,\"brent\" ,\"alice\" ,\"anna\" ,\"brenda\" ,\"claudia\" ,\"debby\" ,\"helen\" ,\"jerry\" ,\"jimmy\" ,\"julie\" ,\"linda\" ,\"sandra\"` or any 1-3 random characters\n\nto one one the following domains:\n\n* aol.com\n* msn.com\n* yahoo.com\n* hotmail.com\n\n### Generating Attachment\nIt makes a copy of itself under one of the followng names: document, readme, doc, text, file, data, test, text, message, body and adds one or two of the following extensions: pif, scr, exe, cmd, bat, HTM, TXT or DOC\n\n### Generating Message\nIt chooses one of the following subjects or any 3 to 16 random letters\n\n* test\n* hi\n* hello\n* Mail Delivery System\n* Mail Transaction Failed\n* Server Report\n* Status\n* Error\n\nand one of the following messages:\n\n* test\n* The message cannot be represented in 7-bit ASCII encoding and has been sent as a binary attachment.\n* The message contains Unicode characters and has been sent as a binary attachment.\n* Mail transaction failed. Partial message is available.\n\n## Gathering E-mail Addresses\nThe worm looks in `HKCU\\Software\\Microsoft\\WAB\\WAB4\\Wab File Name` (Windows Address Book) which contains emails saved on the machine and skips emails that contain: .edu\n\nIt then scans internet temp directories `C:\\Windows\\Temporary Internet Files` and `C:\\Users\\<username>\\AppData\\Local\\Internet Temporary Files` for valid emails, and then it scans all drives for files with the following extensions: txt ,htm ,sht ,php ,asp ,dbx ,tbb ,adb, pl , wab\n\nIt skips emails with these domains: `\"avp\", \"syma\", \"icrosof\", \"msn.\", \"hotmail\", \"panda\",\"sopho\", \"borlan\", \"inpris\", \"example\", \"mydomai\", \"nodomai\",\"ruslis\", \".gov\", \"gov.\", \".mil\", \"foo.\"` , and checks that the sender and the reciever\u2019s emails don\u2019t contain any of the following substrings: `anyone, bugs, ca, contact, feste, gold-certs, help, info, me, no, nobody, noone, not, nothing, page, postmaster, privacy, rating, root, samples, service, site, soft, somebody, someone, submit, the.bat, webmaster, you, yours , \"berkeley\", \"unix\", \"math\", \"bsd\", \"mit.e\", \"gnu\", \"fsf.\", \"ibm.com\", \"google\", \"kernel\", \"linux\", \"fido\", \"usenet\",\"iana\", \"ietf\", \"rfc-ed\", \"sendmail\", \"arin.\", \"ripe.\", \"isi.e\", \"isc.o\", \"secur\", \"acketst\", \"pgp\", \"tanford.e\", \"utgers.ed\", \"mozilla\" , \"admin\", \"icrosoft\", \"support\", \"ntivi\", \"unix\", \"bsd\", \"linux\", \"listserv\", \"certific\", \"google\", \"accoun\", abuse , secur ,spam , www`\n\n# Expiry Date\nThe sample gets the current system time and compares it to `2004-02-12` to make sure it doesn\u2019t execute the malicious code after that date. However, the backdoor `shimgapi.dll` remains open.\n\n# Start Execution\nThe sample gets the current system time and date to make sure the day is after `2004-02-01` and the time is after `16:09:18` before it starts execution. Hence not every infected machine will perform the attack, it depends on the system time.\n\nTo get the hardcoded time i converted the two 32-bit values at dwLowDateTime and dwHighDateTime to a 64-bit value (filetime format)\n\n\tdwLowDateTime = 0x0BE9ECB00\n\tdwHighDateTime = 0x1C3E8DD << 32\n\texecution_filetime = (dwLowDateTime & 0xFFFFFFFF) + dwHighDateTime\n\nthen i used [https://gist.github.com/Mostafa-Hamdy-Elgiar/9714475f1b3bc224ea063af81566d873](https://gist.github.com/Mostafa-Hamdy-Elgiar/9714475f1b3bc224ea063af81566d873) script to convert it to datetime.\n\n\n"}, {"tool": "processmonitor", "activity": "Open tool", "executable": "Procmon.exe", "arguments": [], "log_time": 1703412250.1846473, "notes": "# Execution\n\n## Check first run\nThe sample attemps to open  `Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\Version` subkey of the root key HKEY_LOCAL_MACHINE (0x80000002) once and HKEY_CURRENT_USER (0x80000002-0x1) once and creates them if it failed to open them in attempt to find out if this is the first time it executes or not.\n\nIf it managed to open any of them it knows it\u2019s already been executed before so it creates the mutex `SwebSipcSmtxS0` to make sure only one instance of it is running.\n\n## First execution\nThe sample creates and opens a text file called Message full of garbage at the Temp Directory `C:\\Users\\<username>\\AppData\\Local`\n\n## Dropped Files\nThe sample drops a dll called `shimgapi.dll` in the system directory which serves as a backdoor.\n\nIt copies itself in the system directory under the name of `taskmon.exe` which was a valid windows process back then.\n\n## Persistence\nIt creates the registry key `TaskMon` in `Software\\Microsoft\\Windows\\CurrentVersion\\Run` to automatically run during system startup without requiring user interaction.\n"}, {"tool": "processmonitor", "activity": "Close tool", "executable": "Procmon.exe", "arguments": ["/originalpath", "C:\\Users\\user\\Desktop\\Procmon.exe"], "log_time": 1703412948.9404848, "notes": ""}, {"tool": "wireshark", "activity": "Open tool", "executable": "Wireshark.exe", "arguments": [], "log_time": 1703412966.5498598, "notes": "# DoS Attack\nFirst it will check if the machine is connected to the internet, then it creates 63 threads and sends a \u2018GET /HTTP/1.1\u2019 request from each one of them to `www.sco.com` on TCP port 80"}, {"tool": "wireshark", "activity": "Close tool", "executable": "Wireshark.exe", "arguments": [], "log_time": 1703414031.7915766, "notes": ""}, {"tool": "idapro", "activity": "Close tool", "executable": "ida64.exe", "arguments": [], "log_time": 1703414040.366852, "notes": ""}]}